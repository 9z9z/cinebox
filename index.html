<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>📽️ فاصل أفلام ومسلسلات وأنمي - التوب بالعالم</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Tajawal&display=swap');
  * {
    box-sizing: border-box;
  }
  body {
    margin:0; padding:0;
    background: #0a0a0a;
    color: #eee;
    font-family: 'Tajawal', sans-serif;
  }
  header {
    background: #111;
    padding: 20px 0;
    text-align: center;
    border-bottom: 3px solid #f00;
  }
  header h1 {
    margin: 0;
    font-size: 32px;
    color: #f00;
    user-select: none;
  }
  nav {
    background: #1b1b1b;
    display: flex;
    justify-content: center;
    gap: 25px;
    padding: 12px 0;
    flex-wrap: wrap;
  }
  nav button {
    background: transparent;
    border: none;
    color: #eee;
    font-weight: bold;
    font-size: 18px;
    cursor: pointer;
    padding: 8px 18px;
    border-radius: 8px;
    transition: background-color 0.3s, color 0.3s;
  }
  nav button.active,
  nav button:hover {
    background-color: #f00;
    color: #fff;
  }
  .container {
    max-width: 1100px;
    margin: 25px auto;
    padding: 0 15px;
  }
  .search-bar {
    display: flex;
    gap: 12px;
    margin-bottom: 25px;
  }
  .search-bar input {
    flex-grow: 1;
    padding: 12px 15px;
    border-radius: 8px;
    border: none;
    background: #222;
    color: #eee;
    font-size: 17px;
    outline: none;
  }
  .search-bar button {
    padding: 12px 20px;
    background: #f00;
    border: none;
    color: #eee;
    font-weight: bold;
    border-radius: 8px;
    cursor: pointer;
    font-size: 17px;
    transition: background-color 0.3s;
  }
  .search-bar button:hover {
    background-color: #c00;
  }
  .media-list {
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(250px,1fr));
    gap: 22px;
  }
  .media-card {
    background: #222;
    border-radius: 14px;
    box-shadow: 0 0 15px #000;
    cursor: pointer;
    transition: transform 0.25s, box-shadow 0.25s;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  .media-card:hover {
    transform: scale(1.05);
    box-shadow: 0 0 25px #f00;
  }
  .media-thumb {
    width: 100%;
    height: 140px;
    object-fit: cover;
    border-bottom: 3px solid #f00;
  }
  .media-info {
    padding: 15px 12px;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }
  .media-info h3 {
    margin: 0 0 8px;
    color: #f00;
    font-size: 20px;
    user-select: none;
  }
  .media-info p {
    font-size: 14px;
    line-height: 1.4;
    color: #ccc;
    flex-grow: 1;
    overflow: hidden;
  }
  .media-info .category {
    margin-top: 10px;
    font-size: 13px;
    color: #f00;
    font-weight: bold;
    user-select: none;
    text-transform: uppercase;
  }
  /* تفاصيل العنصر */
  .details-view {
    background: #111;
    padding: 25px;
    border-radius: 15px;
    max-width: 900px;
    margin: 0 auto 50px auto;
    box-shadow: 0 0 30px #f00;
  }
  .details-view h2 {
    color: #f00;
    margin-top: 0;
    user-select: none;
  }
  .details-view p {
    color: #ccc;
    font-size: 16px;
    line-height: 1.5;
  }
  .details-iframe {
    margin-top: 25px;
    width: 100%;
    height: 420px;
    border-radius: 14px;
    border: none;
    box-shadow: 0 0 15px #f00;
  }
  .details-links {
    margin-top: 20px;
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
  }
  .details-links a {
    background: #f00;
    color: #eee;
    padding: 13px 22px;
    border-radius: 10px;
    font-weight: bold;
    text-decoration: none;
    user-select: none;
    transition: background-color 0.3s;
  }
  .details-links a:hover {
    background-color: #c00;
  }
  .back-btn {
    display: inline-block;
    margin-bottom: 20px;
    color: #f00;
    font-weight: bold;
    cursor: pointer;
    user-select: none;
    transition: color 0.3s;
  }
  .back-btn:hover {
    color: #c00;
  }
  /* نموذج الإضافة */
  .add-form {
    background: #111;
    max-width: 700px;
    margin: 0 auto 50px auto;
    padding: 25px;
    border-radius: 14px;
    box-shadow: 0 0 30px #f00;
  }
  .add-form h2 {
    color: #f00;
    margin-top: 0;
    user-select: none;
  }
  .add-form label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
    user-select: none;
  }
  .add-form input[type="text"],
  .add-form textarea,
  .add-form select {
    width: 100%;
    padding: 12px 15px;
    margin-top: 6px;
    border-radius: 10px;
    border: none;
    background: #222;
    color: #eee;
    font-size: 16px;
    resize: vertical;
    outline: none;
  }
  .add-form textarea {
    min-height: 100px;
  }
  .add-form button {
    margin-top: 25px;
    padding: 14px 25px;
    background: #f00;
    border: none;
    color: #eee;
    font-weight: bold;
    border-radius: 12px;
    font-size: 18px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  .add-form button:hover {
    background-color: #c00;
  }
  .message {
    margin-top: 20px;
    font-weight: bold;
    color: #f00;
    user-select: none;
  }
  /* Responsive tweaks */
  @media (max-width: 600px) {
    nav {
      gap: 10px;
    }
    nav button {
      font-size: 16px;
      padding: 7px 14px;
    }
  }
</style>
</head>
<body>

<header>
  <h1>📽️ فاصل أفلام ومسلسلات وأنمي</h1>
</header>

<nav>
  <button data-cat="all" class="active">الكل</button>
  <button data-cat="movie">أفلام</button>
  <button data-cat="series">مسلسلات</button>
  <button data-cat="anime">أنمي</button>
  <button id="nav-add">أضف جديد (مالك الموقع فقط)</button>
</nav>

<main class="container" id="main-content">
  <!-- هنا المحتوى ديناميكي -->
</main>

<script>
(() => {
  "use strict";

  const OWNER_PASSWORD = "secret123"; // كلمة السر حق مالك الموقع، غيرها على راحتك
  let mediaItems = JSON.parse(localStorage.getItem('mediaItems')) || [];

  // حالة الصفحة
  let currentCategory = 'all';
  let filteredItems = [...mediaItems];
  let currentView = 'list'; // list, details, add
  let currentDetailId = null;

  // العناصر المهمة
  const mainContent = document.getElementById('main-content');
  const navButtons = document.querySelectorAll('nav button[data-cat]');
  const navAddBtn = document.getElementById('nav-add');

  // --- رندر القائمة الرئيسية ---
  function renderList() {
    mainContent.innerHTML = `
      <div class="search-bar">
        <input type="text" id="searchInput" placeholder="ابحث عن عنوان أو وصف..." autofocus />
        <button id="searchBtn">بحث</button>
      </div>
      <div class="media-list"></div>
    `;
    renderMediaCards(filteredItems);
    // ربط البحث
    document.getElementById('searchBtn').onclick = doSearch;
    document.getElementById('searchInput').onkeyup = (e) => {
      if (e.key === "Enter") doSearch();
    };
  }

  // --- عرض بطاقات العناصر ---
  function renderMediaCards(list) {
    const container = mainContent.querySelector('.media-list');
    container.innerHTML = '';
    if (list.length === 0) {
      container.innerHTML = '<p style="text-align:center; user-select:none;">ما فيه عناصر لعرضها.</p>';
      return;
    }
    list.forEach((item, idx) => {
      const card = document.createElement('div');
      card.className = 'media-card';
      card.tabIndex = 0; // للتصفح بالكيبورد
      card.setAttribute('role', 'button');
      card.setAttribute('aria-pressed', 'false');
      card.innerHTML = `
        <img src="${item.thumbnail || 'https://via.placeholder.com/300x140?text=بدون+صورة'}" alt="صورة ${item.title}" class="media-thumb" />
        <div class="media-info">
          <h3>${item.title}</h3>
          <p>${item.description.length > 100 ? item.description.slice(0,100) + "..." : item.description}</p>
          <div class="category">${item.category}</div>
        </div>
      `;
      card.onclick = () => {
        currentView = 'details';
        currentDetailId = idx;
        renderDetails(idx);
      };
      card.onkeydown = (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          card.click();
        }
      };
      container.appendChild(card);
    });
  }

  // --- عرض تفاصيل عنصر ---
  function renderDetails(id) {
    const item = filteredItems[id];
    if(!item) {
      mainContent.innerHTML = `<p style="text-align:center; user-select:none;">العنصر غير موجود.</p>`;
      return;
    }
    mainContent.innerHTML = `
      <span class="back-btn" id="backBtn">← رجوع</span>
      <div class="details-view">
        <h2>${item.title}</h2>
        <p>${item.description}</p>
        <iframe class="details-iframe" src="${item.embed}" allowfullscreen loading="lazy" referrerpolicy="no-referrer"></iframe>
        <div class="details-links">
          ${item.download ? `<a href="${item.download}" target="_blank" rel="noopener noreferrer" download>تحميل</a>` : ''}
        </div>
      </div>
    `;
    document.getElementById('backBtn').onclick = () => {
      currentView = 'list';
      renderList();
    };
  }

  // --- نموذج إضافة عنصر جديد ---
  function renderAddForm() {
    mainContent.innerHTML = `
      <section class="add-form">
        <h2>أضف عنصر جديد</h2>
        <label for="titleInput">العنوان *</label>
        <input type="text" id="titleInput" placeholder="عنوان العنصر" required />

        <label for="descInput">الوصف *</label>
        <textarea id="descInput" placeholder="وصف مختصر عن العنصر" required></textarea>

        <label for="categorySelect">التصنيف *</label>
        <select id="categorySelect" required>
          <option value="" disabled selected>اختر التصنيف</option>
          <option value="movie">فلم</option>
          <option value="series">مسلسل</option>
          <option value="anime">أنمي</option>
        </select>

        <label for="thumbInput">رابط الصورة المصغرة *</label>
        <input type="text" id="thumbInput" placeholder="رابط الصورة" required />

        <label for="embedInput">رابط العرض (iframe) *</label>
        <input type="text" id="embedInput" placeholder="رابط العرض (مثل رابط اليوتيوب)" required />

        <label for="downloadInput">رابط التحميل (اختياري)</label>
        <input type="text" id="downloadInput" placeholder="رابط التحميل" />

        <button id="addBtn">أضف العنصر</button>
        <button id="cancelBtn" style="background:#555; margin-left: 10px;">إلغاء</button>
        <div class="message" id="formMessage"></div>
      </section>
    `;
    document.getElementById('addBtn').onclick = addNewItem;
    document.getElementById('cancelBtn').onclick = () => {
      currentView = 'list';
      renderList();
    };
  }

  // --- إضافة عنصر جديد ---
  function addNewItem() {
    const title = document.getElementById('titleInput').value.trim();
    const desc = document.getElementById('descInput').value.trim();
    const category = document.getElementById('categorySelect').value;
    const thumb = document.getElementById('thumbInput').value.trim();
    const embed = document.getElementById('embedInput').value.trim();
    const download = document.getElementById('downloadInput').value.trim();

    const msg = document.getElementById('formMessage');
    msg.textContent = '';

    if (!title || !desc || !category || !thumb || !embed) {
      msg.textContent = 'عبي كل الحقول المطلوبة يا ذيب!';
      return;
    }
    // تحقق من وجود روابط صحيحة (بسيط)
    if (!isValidURL(thumb) || !isValidURL(embed) || (download && !isValidURL(download))) {
      msg.textContent = 'تأكد من صحة الروابط!';
      return;
    }

    const newItem = {
      title, description: desc, category, thumbnail: thumb, embed, download
    };

    mediaItems.push(newItem);
    localStorage.setItem('mediaItems', JSON.stringify(mediaItems));

    alert('تمت إضافة العنصر يا ذيب 🔥');
    // تحديث الحالة
    currentView = 'list';
    currentCategory = 'all';
    filteredItems = [...mediaItems];
    setActiveCategoryButton('all');
    renderList();
  }

  // --- تحقق بسيط من رابط ---
  function isValidURL(str) {
    try {
      new URL(str);
      return true;
    } catch {
      return false;
    }
  }

  // --- البحث ---
  function doSearch() {
    const keyword = document.getElementById('searchInput').value.trim().toLowerCase();
    if (!keyword) {
      filteredItems = currentCategory === 'all' ? [...mediaItems] : mediaItems.filter(i => i.category === currentCategory);
    } else {
      filteredItems = (currentCategory === 'all' ? mediaItems : mediaItems.filter(i => i.category === currentCategory))
        .filter(i => i.title.toLowerCase().includes(keyword) || i.description.toLowerCase().includes(keyword));
    }
    renderMediaCards(filteredItems);
  }

  // --- تعيين زر الفئة النشط ---
  function setActiveCategoryButton(cat) {
    navButtons.forEach(btn => {
      btn.classList.toggle('active', btn.getAttribute('data-cat') === cat);
    });
  }

  // --- التعامل مع اختيار الفئات ---
  navButtons.forEach(btn => {
    btn.onclick = () => {
      if (currentView !== 'list') {
        currentView = 'list';
        renderList();
      }
      currentCategory = btn.getAttribute('data-cat');
      setActiveCategoryButton(currentCategory);
      // تحديث العناصر حسب التصنيف
      filteredItems = currentCategory === 'all' ? [...mediaItems] : mediaItems.filter(i => i.category === currentCategory);
      renderMediaCards(filteredItems);
    };
  });

  // --- زر إضافة العنصر (يتحقق من كلمة السر) ---
  navAddBtn.onclick = () => {
    const pass = prompt("أدخل كلمة سر مالك الموقع:");
    if (pass === OWNER_PASSWORD) {
      currentView = 'add';
      renderAddForm();
    } else {
      alert("كلمة السر خطأ يا ذيب!");
    }
  };

  // --- تحميل الصفحة ---
  function init() {
    currentView = 'list';
    currentCategory = 'all';
    filteredItems = [...mediaItems];
    setActiveCategoryButton('all');
    renderList();
  }

  // بداية
  init();

})();
</script>

</body>
</html>
