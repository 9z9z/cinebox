<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸ“½ï¸ ÙØ§ØµÙ„ Ø£ÙÙ„Ø§Ù… ÙˆÙ…Ø³Ù„Ø³Ù„Ø§Øª ÙˆØ£Ù†Ù…ÙŠ - Ø§Ù„ØªÙˆØ¨ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù…</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Tajawal&display=swap');
  * {
    box-sizing: border-box;
  }
  body {
    margin:0; padding:0;
    background: #0a0a0a;
    color: #eee;
    font-family: 'Tajawal', sans-serif;
  }
  header {
    background: #111;
    padding: 20px 0;
    text-align: center;
    border-bottom: 3px solid #f00;
  }
  header h1 {
    margin: 0;
    font-size: 32px;
    color: #f00;
    user-select: none;
  }
  nav {
    background: #1b1b1b;
    display: flex;
    justify-content: center;
    gap: 25px;
    padding: 12px 0;
    flex-wrap: wrap;
  }
  nav button {
    background: transparent;
    border: none;
    color: #eee;
    font-weight: bold;
    font-size: 18px;
    cursor: pointer;
    padding: 8px 18px;
    border-radius: 8px;
    transition: background-color 0.3s, color 0.3s;
  }
  nav button.active,
  nav button:hover {
    background-color: #f00;
    color: #fff;
  }
  .container {
    max-width: 1100px;
    margin: 25px auto;
    padding: 0 15px;
  }
  .search-bar {
    display: flex;
    gap: 12px;
    margin-bottom: 25px;
  }
  .search-bar input {
    flex-grow: 1;
    padding: 12px 15px;
    border-radius: 8px;
    border: none;
    background: #222;
    color: #eee;
    font-size: 17px;
    outline: none;
  }
  .search-bar button {
    padding: 12px 20px;
    background: #f00;
    border: none;
    color: #eee;
    font-weight: bold;
    border-radius: 8px;
    cursor: pointer;
    font-size: 17px;
    transition: background-color 0.3s;
  }
  .search-bar button:hover {
    background-color: #c00;
  }
  .media-list {
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(250px,1fr));
    gap: 22px;
  }
  .media-card {
    background: #222;
    border-radius: 14px;
    box-shadow: 0 0 15px #000;
    cursor: pointer;
    transition: transform 0.25s, box-shadow 0.25s;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  .media-card:hover {
    transform: scale(1.05);
    box-shadow: 0 0 25px #f00;
  }
  .media-thumb {
    width: 100%;
    height: 140px;
    object-fit: cover;
    border-bottom: 3px solid #f00;
  }
  .media-info {
    padding: 15px 12px;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }
  .media-info h3 {
    margin: 0 0 8px;
    color: #f00;
    font-size: 20px;
    user-select: none;
  }
  .media-info p {
    font-size: 14px;
    line-height: 1.4;
    color: #ccc;
    flex-grow: 1;
    overflow: hidden;
  }
  .media-info .category {
    margin-top: 10px;
    font-size: 13px;
    color: #f00;
    font-weight: bold;
    user-select: none;
    text-transform: uppercase;
  }
  /* ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù†ØµØ± */
  .details-view {
    background: #111;
    padding: 25px;
    border-radius: 15px;
    max-width: 900px;
    margin: 0 auto 50px auto;
    box-shadow: 0 0 30px #f00;
  }
  .details-view h2 {
    color: #f00;
    margin-top: 0;
    user-select: none;
  }
  .details-view p {
    color: #ccc;
    font-size: 16px;
    line-height: 1.5;
  }
  .details-iframe {
    margin-top: 25px;
    width: 100%;
    height: 420px;
    border-radius: 14px;
    border: none;
    box-shadow: 0 0 15px #f00;
  }
  .details-links {
    margin-top: 20px;
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
  }
  .details-links a {
    background: #f00;
    color: #eee;
    padding: 13px 22px;
    border-radius: 10px;
    font-weight: bold;
    text-decoration: none;
    user-select: none;
    transition: background-color 0.3s;
  }
  .details-links a:hover {
    background-color: #c00;
  }
  .back-btn {
    display: inline-block;
    margin-bottom: 20px;
    color: #f00;
    font-weight: bold;
    cursor: pointer;
    user-select: none;
    transition: color 0.3s;
  }
  .back-btn:hover {
    color: #c00;
  }
  /* Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¶Ø§ÙØ© */
  .add-form {
    background: #111;
    max-width: 700px;
    margin: 0 auto 50px auto;
    padding: 25px;
    border-radius: 14px;
    box-shadow: 0 0 30px #f00;
  }
  .add-form h2 {
    color: #f00;
    margin-top: 0;
    user-select: none;
  }
  .add-form label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
    user-select: none;
  }
  .add-form input[type="text"],
  .add-form textarea,
  .add-form select {
    width: 100%;
    padding: 12px 15px;
    margin-top: 6px;
    border-radius: 10px;
    border: none;
    background: #222;
    color: #eee;
    font-size: 16px;
    resize: vertical;
    outline: none;
  }
  .add-form textarea {
    min-height: 100px;
  }
  .add-form button {
    margin-top: 25px;
    padding: 14px 25px;
    background: #f00;
    border: none;
    color: #eee;
    font-weight: bold;
    border-radius: 12px;
    font-size: 18px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  .add-form button:hover {
    background-color: #c00;
  }
  .message {
    margin-top: 20px;
    font-weight: bold;
    color: #f00;
    user-select: none;
  }
  /* Responsive tweaks */
  @media (max-width: 600px) {
    nav {
      gap: 10px;
    }
    nav button {
      font-size: 16px;
      padding: 7px 14px;
    }
  }
</style>
</head>
<body>

<header>
  <h1>ğŸ“½ï¸ ÙØ§ØµÙ„ Ø£ÙÙ„Ø§Ù… ÙˆÙ…Ø³Ù„Ø³Ù„Ø§Øª ÙˆØ£Ù†Ù…ÙŠ</h1>
</header>

<nav>
  <button data-cat="all" class="active">Ø§Ù„ÙƒÙ„</button>
  <button data-cat="movie">Ø£ÙÙ„Ø§Ù…</button>
  <button data-cat="series">Ù…Ø³Ù„Ø³Ù„Ø§Øª</button>
  <button data-cat="anime">Ø£Ù†Ù…ÙŠ</button>
  <button id="nav-add">Ø£Ø¶Ù Ø¬Ø¯ÙŠØ¯ (Ù…Ø§Ù„Ùƒ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙÙ‚Ø·)</button>
</nav>

<main class="container" id="main-content">
  <!-- Ù‡Ù†Ø§ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ -->
</main>

<script>
(() => {
  "use strict";

  const OWNER_PASSWORD = "secret123"; // ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø­Ù‚ Ù…Ø§Ù„Ùƒ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŒ ØºÙŠØ±Ù‡Ø§ Ø¹Ù„Ù‰ Ø±Ø§Ø­ØªÙƒ
  let mediaItems = JSON.parse(localStorage.getItem('mediaItems')) || [];

  // Ø­Ø§Ù„Ø© Ø§Ù„ØµÙØ­Ø©
  let currentCategory = 'all';
  let filteredItems = [...mediaItems];
  let currentView = 'list'; // list, details, add
  let currentDetailId = null;

  // Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ù‡Ù…Ø©
  const mainContent = document.getElementById('main-content');
  const navButtons = document.querySelectorAll('nav button[data-cat]');
  const navAddBtn = document.getElementById('nav-add');

  // --- Ø±Ù†Ø¯Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ---
  function renderList() {
    mainContent.innerHTML = `
      <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù†ÙˆØ§Ù† Ø£Ùˆ ÙˆØµÙ..." autofocus />
        <button id="searchBtn">Ø¨Ø­Ø«</button>
      </div>
      <div class="media-list"></div>
    `;
    renderMediaCards(filteredItems);
    // Ø±Ø¨Ø· Ø§Ù„Ø¨Ø­Ø«
    document.getElementById('searchBtn').onclick = doSearch;
    document.getElementById('searchInput').onkeyup = (e) => {
      if (e.key === "Enter") doSearch();
    };
  }

  // --- Ø¹Ø±Ø¶ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ù†Ø§ØµØ± ---
  function renderMediaCards(list) {
    const container = mainContent.querySelector('.media-list');
    container.innerHTML = '';
    if (list.length === 0) {
      container.innerHTML = '<p style="text-align:center; user-select:none;">Ù…Ø§ ÙÙŠÙ‡ Ø¹Ù†Ø§ØµØ± Ù„Ø¹Ø±Ø¶Ù‡Ø§.</p>';
      return;
    }
    list.forEach((item, idx) => {
      const card = document.createElement('div');
      card.className = 'media-card';
      card.tabIndex = 0; // Ù„Ù„ØªØµÙØ­ Ø¨Ø§Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯
      card.setAttribute('role', 'button');
      card.setAttribute('aria-pressed', 'false');
      card.innerHTML = `
        <img src="${item.thumbnail || 'https://via.placeholder.com/300x140?text=Ø¨Ø¯ÙˆÙ†+ØµÙˆØ±Ø©'}" alt="ØµÙˆØ±Ø© ${item.title}" class="media-thumb" />
        <div class="media-info">
          <h3>${item.title}</h3>
          <p>${item.description.length > 100 ? item.description.slice(0,100) + "..." : item.description}</p>
          <div class="category">${item.category}</div>
        </div>
      `;
      card.onclick = () => {
        currentView = 'details';
        currentDetailId = idx;
        renderDetails(idx);
      };
      card.onkeydown = (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          card.click();
        }
      };
      container.appendChild(card);
    });
  }

  // --- Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø¹Ù†ØµØ± ---
  function renderDetails(id) {
    const item = filteredItems[id];
    if(!item) {
      mainContent.innerHTML = `<p style="text-align:center; user-select:none;">Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯.</p>`;
      return;
    }
    mainContent.innerHTML = `
      <span class="back-btn" id="backBtn">â† Ø±Ø¬ÙˆØ¹</span>
      <div class="details-view">
        <h2>${item.title}</h2>
        <p>${item.description}</p>
        <iframe class="details-iframe" src="${item.embed}" allowfullscreen loading="lazy" referrerpolicy="no-referrer"></iframe>
        <div class="details-links">
          ${item.download ? `<a href="${item.download}" target="_blank" rel="noopener noreferrer" download>ØªØ­Ù…ÙŠÙ„</a>` : ''}
        </div>
      </div>
    `;
    document.getElementById('backBtn').onclick = () => {
      currentView = 'list';
      renderList();
    };
  }

  // --- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ ---
  function renderAddForm() {
    mainContent.innerHTML = `
      <section class="add-form">
        <h2>Ø£Ø¶Ù Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯</h2>
        <label for="titleInput">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† *</label>
        <input type="text" id="titleInput" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ù†ØµØ±" required />

        <label for="descInput">Ø§Ù„ÙˆØµÙ *</label>
        <textarea id="descInput" placeholder="ÙˆØµÙ Ù…Ø®ØªØµØ± Ø¹Ù† Ø§Ù„Ø¹Ù†ØµØ±" required></textarea>

        <label for="categorySelect">Ø§Ù„ØªØµÙ†ÙŠÙ *</label>
        <select id="categorySelect" required>
          <option value="" disabled selected>Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ</option>
          <option value="movie">ÙÙ„Ù…</option>
          <option value="series">Ù…Ø³Ù„Ø³Ù„</option>
          <option value="anime">Ø£Ù†Ù…ÙŠ</option>
        </select>

        <label for="thumbInput">Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…ØµØºØ±Ø© *</label>
        <input type="text" id="thumbInput" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©" required />

        <label for="embedInput">Ø±Ø§Ø¨Ø· Ø§Ù„Ø¹Ø±Ø¶ (iframe) *</label>
        <input type="text" id="embedInput" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø¹Ø±Ø¶ (Ù…Ø«Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ÙŠÙˆØªÙŠÙˆØ¨)" required />

        <label for="downloadInput">Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
        <input type="text" id="downloadInput" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„" />

        <button id="addBtn">Ø£Ø¶Ù Ø§Ù„Ø¹Ù†ØµØ±</button>
        <button id="cancelBtn" style="background:#555; margin-left: 10px;">Ø¥Ù„ØºØ§Ø¡</button>
        <div class="message" id="formMessage"></div>
      </section>
    `;
    document.getElementById('addBtn').onclick = addNewItem;
    document.getElementById('cancelBtn').onclick = () => {
      currentView = 'list';
      renderList();
    };
  }

  // --- Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ ---
  function addNewItem() {
    const title = document.getElementById('titleInput').value.trim();
    const desc = document.getElementById('descInput').value.trim();
    const category = document.getElementById('categorySelect').value;
    const thumb = document.getElementById('thumbInput').value.trim();
    const embed = document.getElementById('embedInput').value.trim();
    const download = document.getElementById('downloadInput').value.trim();

    const msg = document.getElementById('formMessage');
    msg.textContent = '';

    if (!title || !desc || !category || !thumb || !embed) {
      msg.textContent = 'Ø¹Ø¨ÙŠ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙŠØ§ Ø°ÙŠØ¨!';
      return;
    }
    // ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø±ÙˆØ§Ø¨Ø· ØµØ­ÙŠØ­Ø© (Ø¨Ø³ÙŠØ·)
    if (!isValidURL(thumb) || !isValidURL(embed) || (download && !isValidURL(download))) {
      msg.textContent = 'ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·!';
      return;
    }

    const newItem = {
      title, description: desc, category, thumbnail: thumb, embed, download
    };

    mediaItems.push(newItem);
    localStorage.setItem('mediaItems', JSON.stringify(mediaItems));

    alert('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†ØµØ± ÙŠØ§ Ø°ÙŠØ¨ ğŸ”¥');
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©
    currentView = 'list';
    currentCategory = 'all';
    filteredItems = [...mediaItems];
    setActiveCategoryButton('all');
    renderList();
  }

  // --- ØªØ­Ù‚Ù‚ Ø¨Ø³ÙŠØ· Ù…Ù† Ø±Ø§Ø¨Ø· ---
  function isValidURL(str) {
    try {
      new URL(str);
      return true;
    } catch {
      return false;
    }
  }

  // --- Ø§Ù„Ø¨Ø­Ø« ---
  function doSearch() {
    const keyword = document.getElementById('searchInput').value.trim().toLowerCase();
    if (!keyword) {
      filteredItems = currentCategory === 'all' ? [...mediaItems] : mediaItems.filter(i => i.category === currentCategory);
    } else {
      filteredItems = (currentCategory === 'all' ? mediaItems : mediaItems.filter(i => i.category === currentCategory))
        .filter(i => i.title.toLowerCase().includes(keyword) || i.description.toLowerCase().includes(keyword));
    }
    renderMediaCards(filteredItems);
  }

  // --- ØªØ¹ÙŠÙŠÙ† Ø²Ø± Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù†Ø´Ø· ---
  function setActiveCategoryButton(cat) {
    navButtons.forEach(btn => {
      btn.classList.toggle('active', btn.getAttribute('data-cat') === cat);
    });
  }

  // --- Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ¦Ø§Øª ---
  navButtons.forEach(btn => {
    btn.onclick = () => {
      if (currentView !== 'list') {
        currentView = 'list';
        renderList();
      }
      currentCategory = btn.getAttribute('data-cat');
      setActiveCategoryButton(currentCategory);
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ
      filteredItems = currentCategory === 'all' ? [...mediaItems] : mediaItems.filter(i => i.category === currentCategory);
      renderMediaCards(filteredItems);
    };
  });

  // --- Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†ØµØ± (ÙŠØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±) ---
  navAddBtn.onclick = () => {
    const pass = prompt("Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø³Ø± Ù…Ø§Ù„Ùƒ Ø§Ù„Ù…ÙˆÙ‚Ø¹:");
    if (pass === OWNER_PASSWORD) {
      currentView = 'add';
      renderAddForm();
    } else {
      alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø·Ø£ ÙŠØ§ Ø°ÙŠØ¨!");
    }
  };

  // --- ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ---
  function init() {
    currentView = 'list';
    currentCategory = 'all';
    filteredItems = [...mediaItems];
    setActiveCategoryButton('all');
    renderList();
  }

  // Ø¨Ø¯Ø§ÙŠØ©
  init();

})();
</script>

</body>
</html>
